<% content_for :title do   %>
  <ol class="th breadcrumb">
    <li>Mail</li>
    <li><%= link_to 'Emails', mail_path %></li>
  </ol>
<% end %>
<% content_for :section do %>Email <%= @email %><% end %>

<div class="pull-right">
  <div class="btn-group">
    <% if can? :update, @email %>
      <%= link_to edit_domain_email_path(@domain, @email), :class => 'btn btn-secondary btn-sm', :title => 'Edit email', :data => {:toggle => 'tooltip'}  do %>
        <i class="fa fa-pencil"></i>
      <% end %>
    <% end %>
    <% if can? :destroy, @email %>
      <%= link_to domain_email_path(@domain, @email),
                            :method => :delete,
                            :title => 'Delete email',
                            data: { confirm: 'Are you sure you want to delete this email?',
                                    :toggle => 'tooltip' },
                            :class => 'btn btn-secondary btn-sm' do %>
        <i class="fa fa-trash"></i>
      <% end %>
    <% end %>
  </div>
</div>

<table class="th attribute-table">
  <tr>
    <td>Email</td>
    <td><%= @email %></td>
  </tr>
  <tr>
    <td>Domain</td>
    <td><%= link_to @email.domain.domain, domain_path(@email.domain) %></td>
  </tr>
</table>

<div class="title-heading">
  <h3>Members</h3>
</div>

<% if @permission_group.nil? %>
  <div class="alert alert-danger">
    <strong><i class="fa fa-exclamation-triangle"></i> Email account does not have an associated permission group.</strong>
  </div>
  <p>
    Please create a group named <em><%= @email %></em> to allow access control.
  </p>
<% else %>
  <div class="alert alert-info">
    This email account has an associated <strong><%= link_to 'permission group', group_path(@email.permission_group) %></strong>
  </div>
  <% if @permission_group.users.any? %>
    <ul>
      <% @permission_group.users.each do |user| %>
        <li><%= link_to user.display_name, user_path(user) %>
      <% end %>
    </ul>
  <% else %>
    <center><em>No active emails</em></center>
  <% end %>
<% end %>
