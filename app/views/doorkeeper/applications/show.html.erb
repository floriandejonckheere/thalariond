<% content_for :title do   %>
  <ol class="breadcrumb">
    <li>Admin</li>
    <li><%= link_to 'OAuth2', oauth_applications_path %></li>
  </ol>
<% end %>
<% content_for :section do %>OAuth2 application <%= @application.name %><% end %>

<div class="pull-right">
  <div class="btn-group">
    <%= link_to edit_oauth_application_path(@application), :class => 'btn btn-secondary btn-sm', :title => 'Edit domain', :data => {:toggle => 'tooltip'}  do %>
      <i class="fa fa-pencil"></i>
    <% end %>
    <%= link_to oauth_application_path(@application),
                          :method => :delete,
                          :title => 'Delete application',
                          data: { confirm: 'Are you sure you want to delete this application?',
                                  :toggle => 'tooltip' },
                          :class => 'btn btn-secondary btn-sm' do %>
      <i class="fa fa-trash"></i>
    <% end %>
  </div>
</div>

<table class="attribute-table">
  <tr>
    <td>Name</td>
    <td><%= @application.name %></td>
  </tr>
  <tr>
    <td>Scopes</td>
    <td>
      <% if @application.scopes.blank? %>
        <em>No scopes defined</em>
      <% else %>
        <ul>
          <% @application.scopes.each do |scope| %>
            <li><%= scope %></li>
          <% end %>
        </ul>
      <% end %>
    </td>
  </tr>
</table>


<div class="title-heading">
  <h3>Secret token</h3>
</div>

<div class="secret"><%= @application.secret %></div>


<div class="title-heading">
  <h3>Callback URI</h3>
</div>

<div class="row">
  <div class="col-xs-6">
    <% if @application.redirect_uri.blank? %>
      <em>No callback URI defined</em>
    <% else %>
      <table class="table">
        <thead>
          <tr>
            <th>URI</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <% @application.redirect_uri.split.each do |uri| %>
            <tr>
              <td>
                <code><%= uri %></code>
              </td>
              <td>
                <%= link_to oauth_authorization_path(client_id: @application.uid, redirect_uri: uri, response_type: 'code'),
                              :class => 'btn btn-success btn-sm',
                              :title => 'Authorize',
                              data: { :toggle => 'tooltip' },
                              :target => '_blank' do %>
                  <i class="fa fa-check"></i>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% end %>
  </div>
</div>
