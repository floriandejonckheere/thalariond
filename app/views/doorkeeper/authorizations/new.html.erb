<% content_for 'title' do %>Authorize application<% end %>

<% if flash.any? %>
  <div class="card-block">
    <% flash.each do |key, value| %>
      <% if not value.blank? %>
        <div class="text-danger text-xs-center ">
          <strong><%= value %></strong>
        </div>
      <% end %>
    <% end %>
  </div>
<% end %>

<div class="card-block" id="oauth-permissions">
  <% if @pre_auth.scopes.count > 0 %>
    <p><strong><%= @pre_auth.client.name %></strong> is requesting permission to:</p>

    <ul>
      <% @pre_auth.scopes.each do |scope| %>
        <li><%= t scope, scope: [:doorkeeper, :scopes] %></li>
      <% end %>
    </ul>
  <% else %>
    <p>Allow <strong><%= @pre_auth.client.name %></strong> to access your account?</p>
  <% end %>
</div>

<div class="card-block clearfix">
  <%= link_to 'Allow', oauth_authorization_path(
                                                :client_id => @pre_auth.client.uid,
                                                :redirect_uri => @pre_auth.redirect_uri,
                                                :state => @pre_auth.state,
                                                :response_type => @pre_auth.response_type,
                                                :scope => @pre_auth.scope
                                                ),
                      :method => :post,
                      :class => 'btn btn-success p-x-2' %>
  <%= link_to 'Deny', oauth_authorization_path(
                                                :client_id => @pre_auth.client.uid,
                                                :redirect_uri => @pre_auth.redirect_uri,
                                                :state => @pre_auth.state,
                                                :response_type => @pre_auth.response_type,
                                                :scope => @pre_auth.scope
                                                ),
                      :method => :delete,
                      :class => 'btn text-danger p-x-2 pull-lg-right' %>
</div>
