<% content_for 'title' do %>Authorize application<% end %>

<% if flash.any? %>
  <div class="m-b-2">
    <% flash.each do |key, value| %>
      <% if not value.blank? %>
        <div class="text-danger text-xs-center ">
          <strong><%= value %></strong>
        </div>
      <% end %>
    <% end %>
  </div>
<% end %>

<% if @pre_auth.scopes.count > 0 %>
  <div id="oauth-permissions">
    <p><strong><%= @pre_auth.client.name %></strong> is requesting permission to:</p>

    <ul>
      <% @pre_auth.scopes.each do |scope| %>
        <li><%= t scope, scope: [:doorkeeper, :scopes] %></li>
      <% end %>
    </ul>
  </div>
<% else %>
  <p>Allow <strong><%= @pre_auth.client.name %></strong> to access your account?</p>
<% end %>

<div class="m-t-3">
  <%= form_tag oauth_authorization_path, :method => :post, :class => 'inline' do %>
    <%= hidden_field_tag :client_id, @pre_auth.client.uid %>
    <%= hidden_field_tag :redirect_uri, @pre_auth.redirect_uri %>
    <%= hidden_field_tag :state, @pre_auth.state %>
    <%= hidden_field_tag :response_type, @pre_auth.response_type %>
    <%= hidden_field_tag :scope, @pre_auth.scope %>
    <%= submit_tag 'Allow', :class => 'btn btn-success p-x-2' %>
  <% end %>
  <%= form_tag oauth_authorization_path, :method => :delete, :class => 'pull-xs-right' do %>
    <%= hidden_field_tag :client_id, @pre_auth.client.uid %>
    <%= hidden_field_tag :redirect_uri, @pre_auth.redirect_uri %>
    <%= hidden_field_tag :state, @pre_auth.state %>
    <%= hidden_field_tag :response_type, @pre_auth.response_type %>
    <%= hidden_field_tag :scope, @pre_auth.scope %>
    <%= submit_tag 'Deny', class: 'btn btn-danger p-x-2' %>
  <% end %>
</div>
